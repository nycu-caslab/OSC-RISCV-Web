
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lab 4: Exception and Interrupt &#8212; CSIC30016: Operating System Capstone</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'labs/lab4';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lab 5: Thread and User Process" href="lab5.html" />
    <link rel="prev" title="Lab 3: Memory Allocator" href="lab3.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">CSIC30016: Operating System Capstone</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Class:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../class/staff.html">Staff</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="lab0.html">Lab 0: Environment Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab1.html">Lab 1: Hello World</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab2.html">Lab 2: Booting</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab3.html">Lab 3: Memory Allocator</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lab 4: Exception and Interrupt</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab5.html">Lab 5: Thread and User Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="lab6.html">Lab 6: Virtual Memory</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../references/external_resources.html">External Resourses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references/old_course.html">Old Course Websites</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/labs/lab4.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Lab 4: Exception and Interrupt</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goals-of-this-lab">Goals of this lab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#official-reference">Official Reference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exception-levels-privilege-modes">Exception Levels (Privilege Modes)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interrupts-and-the-clint">Interrupts and the CLINT</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interrupt-controllers-plic">Interrupt Controllers - PLIC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-sections">Critical Sections</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercises">Basic Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-1-exception-30">Basic Exercise 1 - Exception  - 30%</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mode-switch-m-mode-to-u-mode">Mode Switch: M-mode to U-mode</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trap-handling-from-u-mode">Trap Handling from U-mode</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-2-core-timer-interrupt-10">Basic Exercise 2 - Core Timer Interrupt - 10%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-3-vf2-uart0-interrupt-30">Basic Exercise 3 - VF2 UART0 Interrupt - 30%</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercises">Advanced Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercise-1-timer-multiplexing-20">Advanced Exercise 1 - Timer Multiplexing - 20%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercise-2-concurrent-i-o-devices-handling-20">Advanced Exercise 2 - Concurrent I/O Devices Handling 20%</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This document is currently under construction and may be incomplete or subject to significant changes.
Please check back later for updates, and consult the instructor if you are unsure about any missing parts.</p>
</div>
<section id="lab-4-exception-and-interrupt">
<h1>Lab 4: Exception and Interrupt<a class="headerlink" href="#lab-4-exception-and-interrupt" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>An exception is an event that causes the currently executing program to relinquish the CPU to the corresponding handler.
With the exception mechanism, an operating system can</p>
<ol class="arabic simple">
<li><p>handle errors properly during execution,</p></li>
<li><p>allow user programs to request system services,</p></li>
<li><p>respond to peripheral devices that require immediate attention.</p></li>
</ol>
</section>
<section id="goals-of-this-lab">
<h2>Goals of this lab<a class="headerlink" href="#goals-of-this-lab" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Understand the exception mechanism in RISC-V.</p></li>
<li><p>Understand how interrupt delegation works in the VF2 platform.</p></li>
<li><p>Configure and handle timer interrupts using the CLINT.</p></li>
<li><p>Understand and handle UART interrupts via the PLIC.</p></li>
<li><p>Learn how to multiplex timers and schedule asynchronous tasks.</p></li>
</ul>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h2>
<section id="official-reference">
<h3>Official Reference<a class="headerlink" href="#official-reference" title="Link to this heading">#</a></h3>
<p>Exceptions and interrupts in RISC-V are defined in the official privileged specification. For details, see:</p>
<ul class="simple">
<li><p>RISC-V Privileged Architecture Manual: <a class="github reference external" href="https://github.com/riscv/riscv-isa-manual/releases">riscv/riscv-isa-manual</a></p></li>
</ul>
</section>
<section id="exception-levels-privilege-modes">
<h3>Exception Levels (Privilege Modes)<a class="headerlink" href="#exception-levels-privilege-modes" title="Link to this heading">#</a></h3>
<p>RISC-V defines four privilege modes: User, Supervisor, Hypervisor (optional), and Machine mode.
For simplicity, VF2 boots in <strong>Machine mode (M-mode)</strong>, and most bare-metal kernels are executed in M-mode.</p>
<p>In this lab, you will run both kernel and user-mode programs, using <cite>mret</cite> to switch from M-mode to U-mode,
and configuring trap handling via <cite>mtvec</cite>, <cite>mscratch</cite>, <cite>mepc</cite>, <cite>mcause</cite>, <cite>mstatus</cite>, and <cite>medeleg</cite>/<cite>mideleg</cite>.</p>
</section>
<section id="interrupts-and-the-clint">
<h3>Interrupts and the CLINT<a class="headerlink" href="#interrupts-and-the-clint" title="Link to this heading">#</a></h3>
<p>The Core Local Interruptor (CLINT) is responsible for managing timer and software interrupts for each core.</p>
<p>Registers include:</p>
<ul class="simple">
<li><p><cite>mtime</cite>: a 64-bit timer that increments at a fixed frequency.</p></li>
<li><p><cite>mtimecmp[h]</cite>: a 64-bit comparator register that triggers an interrupt when <cite>mtime &gt;= mtimecmp</cite>.</p></li>
</ul>
<p>Each hart (hardware thread) has its own <cite>mtimecmp</cite> register.</p>
</section>
<section id="interrupt-controllers-plic">
<h3>Interrupt Controllers - PLIC<a class="headerlink" href="#interrupt-controllers-plic" title="Link to this heading">#</a></h3>
<p>VF2 uses the <strong>Platform-Level Interrupt Controller (PLIC)</strong> to handle external interrupts from devices such as UART.</p>
<p>Key facts:</p>
<ul class="simple">
<li><p>Each device interrupt has an ID (e.g., UART0 is usually ID 10).</p></li>
<li><p>PLIC routes interrupt requests to CPU cores with a priority mechanism.</p></li>
<li><p>Each hart has context-specific registers to claim/complete interrupts.</p></li>
</ul>
<p>See JH7110 documentation or DTB for actual interrupt IDs and PLIC base addresses.</p>
</section>
<section id="critical-sections">
<h3>Critical Sections<a class="headerlink" href="#critical-sections" title="Link to this heading">#</a></h3>
<p>As in all interrupt-driven systems, shared data must be protected from concurrent access during interrupt handling.
In RISC-V, this can be done by disabling interrupts via <cite>csrci mstatus, MSTATUS_MIE</cite> and re-enabling via <cite>csrsi</cite>.</p>
</section>
</section>
<section id="basic-exercises">
<h2>Basic Exercises<a class="headerlink" href="#basic-exercises" title="Link to this heading">#</a></h2>
<section id="basic-exercise-1-exception-30">
<h3>Basic Exercise 1 - Exception  - 30%<a class="headerlink" href="#basic-exercise-1-exception-30" title="Link to this heading">#</a></h3>
<section id="mode-switch-m-mode-to-u-mode">
<h4>Mode Switch: M-mode to U-mode<a class="headerlink" href="#mode-switch-m-mode-to-u-mode" title="Link to this heading">#</a></h4>
<p>After booting in M-mode, configure registers to switch to U-mode and run user-level programs.
Setup includes:</p>
<ol class="arabic simple">
<li><p>Writing user program address to <cite>mepc</cite></p></li>
<li><p>Setting <cite>mstatus</cite> to enable interrupts and select U-mode</p></li>
<li><p>Using <cite>mret</cite> to jump to U-mode</p></li>
</ol>
</section>
<section id="trap-handling-from-u-mode">
<h4>Trap Handling from U-mode<a class="headerlink" href="#trap-handling-from-u-mode" title="Link to this heading">#</a></h4>
<p>When the user program executes an <cite>ecall</cite>, it traps to the M-mode handler.
You need to:</p>
<ul class="simple">
<li><p>Set the trap vector address in <cite>mtvec</cite></p></li>
<li><p>Save user context (<cite>x1-x31</cite>, <cite>mepc</cite>, <cite>mstatus</cite>)</p></li>
<li><p>Print diagnostic info from <cite>mcause</cite>, <cite>mepc</cite>, <cite>mtval</cite></p></li>
<li><p>Restore context and return to user using <cite>mret</cite></p></li>
</ul>
</section>
</section>
<section id="basic-exercise-2-core-timer-interrupt-10">
<h3>Basic Exercise 2 - Core Timer Interrupt - 10%<a class="headerlink" href="#basic-exercise-2-core-timer-interrupt-10" title="Link to this heading">#</a></h3>
<p>Enable <cite>mtimecmp</cite> to raise a timer interrupt after a specified period.
Steps:</p>
<ul class="simple">
<li><p>Read <cite>mtime</cite></p></li>
<li><p>Add time delta (e.g., equivalent of 1 second)</p></li>
<li><p>Write to <cite>mtimecmp</cite></p></li>
<li><p>Enable <cite>MIE</cite> in <cite>mstatus</cite> and <cite>MTIE</cite> in <cite>mie</cite></p></li>
<li><p>In the interrupt handler, acknowledge and reprogram <cite>mtimecmp</cite></p></li>
</ul>
<p>Print boot-time seconds in the handler.</p>
</section>
<section id="basic-exercise-3-vf2-uart0-interrupt-30">
<h3>Basic Exercise 3 - VF2 UART0 Interrupt - 30%<a class="headerlink" href="#basic-exercise-3-vf2-uart0-interrupt-30" title="Link to this heading">#</a></h3>
<p>Enable UART0 interrupt via:</p>
<ul class="simple">
<li><p>UART interrupt enable register (check VF2 SoC manual or DTS; likely <cite>UART0.IER</cite>)</p></li>
<li><p>Enable UART interrupt ID (e.g., 10) in the PLIC</p></li>
<li><p>Set <cite>mie.MEIE</cite> and enable external interrupts globally</p></li>
</ul>
<p>Steps:</p>
<ol class="arabic simple">
<li><p>Setup read/write buffers.</p></li>
<li><p>Implement ISR for UART RX and TX.</p></li>
<li><p>In RX, place incoming bytes in buffer.</p></li>
<li><p>In TX, send data from buffer when ready.</p></li>
</ol>
<p>Make shell non-blocking by using buffer for input/output.</p>
</section>
</section>
<section id="advanced-exercises">
<h2>Advanced Exercises<a class="headerlink" href="#advanced-exercises" title="Link to this heading">#</a></h2>
<section id="advanced-exercise-1-timer-multiplexing-20">
<h3>Advanced Exercise 1 - Timer Multiplexing - 20%<a class="headerlink" href="#advanced-exercise-1-timer-multiplexing-20" title="Link to this heading">#</a></h3>
<p>Use <cite>add_timer(callback, duration)</cite> API to schedule deferred tasks.
Use a software-managed priority queue (e.g., min-heap or sorted list) to keep track of expiration time and reprogram <cite>mtimecmp</cite> accordingly.</p>
</section>
<section id="advanced-exercise-2-concurrent-i-o-devices-handling-20">
<h3>Advanced Exercise 2 - Concurrent I/O Devices Handling 20%<a class="headerlink" href="#advanced-exercise-2-concurrent-i-o-devices-handling-20" title="Link to this heading">#</a></h3>
<p>Replace blocking UART logic with event queue mechanism:</p>
<ul class="simple">
<li><p>ISR enqueues tasks to be handled outside critical path</p></li>
<li><p>Enable nesting and priority-based dispatch</p></li>
<li><p>Protect shared state using interrupt masking (<cite>mstatus</cite>)</p></li>
<li><p>Before returning from handler, process pending tasks with interrupts re-enabled</p></li>
</ul>
<p>Preemption can be implemented by checking the event queue for higher-priority tasks before final return from trap.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use nested interrupt handling and task prioritization to support fair and responsive device scheduling.</p>
</div>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lab3.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 3: Memory Allocator</p>
      </div>
    </a>
    <a class="right-next"
       href="lab5.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 5: Thread and User Process</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#goals-of-this-lab">Goals of this lab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#official-reference">Official Reference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exception-levels-privilege-modes">Exception Levels (Privilege Modes)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interrupts-and-the-clint">Interrupts and the CLINT</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interrupt-controllers-plic">Interrupt Controllers - PLIC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#critical-sections">Critical Sections</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercises">Basic Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-1-exception-30">Basic Exercise 1 - Exception  - 30%</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mode-switch-m-mode-to-u-mode">Mode Switch: M-mode to U-mode</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#trap-handling-from-u-mode">Trap Handling from U-mode</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-2-core-timer-interrupt-10">Basic Exercise 2 - Core Timer Interrupt - 10%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-exercise-3-vf2-uart0-interrupt-30">Basic Exercise 3 - VF2 UART0 Interrupt - 30%</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercises">Advanced Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercise-1-timer-multiplexing-20">Advanced Exercise 1 - Timer Multiplexing - 20%</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-exercise-2-concurrent-i-o-devices-handling-20">Advanced Exercise 2 - Concurrent I/O Devices Handling 20%</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By  NYCU cas-lab
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, NYCU cas-lab.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>